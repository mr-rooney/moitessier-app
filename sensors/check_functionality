#!/bin/bash
# This script is used to check the functionality of the onboard sensors of
# the Moitessier HAT.
# Depending on your hardware you might not have all of the sensors populated.

echo "********** CPU **********"
cpuTempPath=/sys/class/thermal/thermal_zone0/temp
if [ -f "$cpuTempPath" ]; then
    cpuTemp=$(cat /sys/class/thermal/thermal_zone0/temp)
    echo 3 k $cpuTemp 1000 / p | dc
else
    echo "Cannot get CPU temperature"    
fi
echo "********** MS5607-02BA03 **********"
./MS5607-02BA03 &
sleep 3
pid=$(pidof MS5607-02BA03)
kill -9 $pid
echo "********** MPU-9250 **********"
./MPU-9250 &
sleep 3
pid=$(pidof MPU-9250)
kill -9 $pid
echo "********** Si7020-A20 **********"
./Si7020-A20 &
sleep 3
pid=$(pidof Si7020-A20)
kill -9 $pid

